<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jour 05 - Inscription</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Style identique au header de l'image */
        .header-custom {
            background-color: #198754; 
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            margin-bottom: 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* Zone d'erreurs globales (haut de page comme sur l'image) */
        #global-errors {
            text-align: center;
            color: #dc3545;
            font-weight: bold;
            margin-bottom: 20px;
            min-height: 20px;
        }

        /* Message d'erreur sous chaque champ */
        .error-text {
            color: #dc3545; /* Rouge erreur */
            font-size: 0.85rem;
            margin-top: 4px;
            display: none; /* Caché par défaut */
        }
        
        /* Bordure rouge quand erreur */
        .is-invalid {
            border-color: #dc3545 !important;
        }
    </style>
</head>
<body>

<div class="container mt-4">
    
    <div class="header-custom shadow">
    <h1 class="h3 m-0 fw-bold">Jour 05</h1>
    <div>
        <a href="inscription.html" class="btn btn-light rounded-pill fw-bold">Inscription</a>
        
        <a href="connexion.html" class="btn btn-outline-light rounded-pill text-white ms-2">Connexion</a>
    </div>
</div>

    <div id="global-errors"></div>

    <div class="card p-4 shadow-sm border-0">
        <form id="registerForm" novalidate>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="prenom" class="form-label">Prénom</label>
                    <input type="text" class="form-control" id="prenom" placeholder="ee">
                    <div class="error-text" id="err-prenom">La taille de votre prénom est trop petite (min 3 caractères)</div>
                </div>
                <div class="col-md-6">
                    <label for="nom" class="form-label">Nom</label>
                    <input type="text" class="form-control" id="nom" placeholder="re">
                    <div class="error-text" id="err-nom">La taille de votre nom est trop petite (min 3 caractères)</div>
                </div>
            </div>

            <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" placeholder="john@doe.fr" style="background-color: #e9ecef;">
                <div class="error-text" id="err-email">Format email invalide</div>
            </div>

            <div class="row mb-3">
                <div class="col-md-8">
                    <label for="adresse" class="form-label">Adresse</label>
                    <input type="text" class="form-control" id="adresse" placeholder="123 Rue de la Paix">
                    <div class="error-text" id="err-adresse">L'adresse est requise</div>
                </div>
                <div class="col-md-4">
                    <label for="cp" class="form-label">Code postal</label>
                    <input type="text" class="form-control" id="cp" placeholder="75000" maxlength="5">
                    <div class="error-text" id="err-cp">Code postal invalide (5 chiffres)</div>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="password" class="form-label">Password</label>
                    <input type="password" class="form-control" id="password" style="background-color: #e9ecef;">
                    <div class="error-text" id="err-password">
                        Minimum 8 caractères, au moins une lettre, un nombre et un caractère spécial.
                    </div>
                </div>
                <div class="col-md-6">
                    <label for="confirm-password" class="form-label">Password Confirmation</label>
                    <input type="password" class="form-control" id="confirm-password">
                    <div class="error-text" id="err-confirm">Les mots de passe ne correspondent pas.</div>
                </div>
            </div>

            <div class="text-center mt-4">
                <button type="submit" class="btn btn-success px-4 py-2">S'inscrire</button>
            </div>

        </form>
    </div>
</div>

<script>
    // --- Configuration des REGEX ---
    // Nom/Prénom : au moins 2 lettres, pas de chiffres bizarres
    const nameRegex = /^[a-zA-Zà-üÀ-Ü\-]{3,}$/;
    // Email standard
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    // Password : Min 8 chars, 1 lettre, 1 chiffre, 1 char spécial (la regex de ton image)
    const passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/;
    // Code postal : exactement 5 chiffres
    const cpRegex = /^[0-9]{5}$/;

    // Fonction générique pour valider un champ
    function validateField(input, regex, errorId) {
        const errorDiv = document.getElementById(errorId);
        const value = input.value;

        // Si la regex ne matche pas
        if (!regex.test(value)) {
            errorDiv.style.display = 'block';
            input.classList.add('is-invalid');
            return false;
        } else {
            errorDiv.style.display = 'none';
            input.classList.remove('is-invalid');
            return true;
        }
    }

    // --- Écouteurs d'événements (Asynchrone / Temps réel) ---
    
    // 1. Prénom
    document.getElementById('prenom').addEventListener('input', function() {
        validateField(this, nameRegex, 'err-prenom');
    });

    // 2. Nom
    document.getElementById('nom').addEventListener('input', function() {
        validateField(this, nameRegex, 'err-nom');
    });

    // 3. Email
    document.getElementById('email').addEventListener('input', function() {
        validateField(this, emailRegex, 'err-email');
    });

    // 4. Code Postal
    document.getElementById('cp').addEventListener('input', function() {
        validateField(this, cpRegex, 'err-cp');
    });

    // 5. Adresse (Juste vérifier si non vide pour l'exemple)
    document.getElementById('adresse').addEventListener('input', function() {
        const errorDiv = document.getElementById('err-adresse');
        if(this.value.length < 5) {
            errorDiv.style.display = 'block';
            this.classList.add('is-invalid');
        } else {
            errorDiv.style.display = 'none';
            this.classList.remove('is-invalid');
        }
    });

    // 6. Password
    const passInput = document.getElementById('password');
    passInput.addEventListener('input', function() {
        validateField(this, passwordRegex, 'err-password');
        // On revérifie la confirmation si le mot de passe change
        checkConfirmation(); 
    });

    // 7. Confirmation Password
    const confirmInput = document.getElementById('confirm-password');
    confirmInput.addEventListener('input', checkConfirmation);

    function checkConfirmation() {
        const errorDiv = document.getElementById('err-confirm');
        if (confirmInput.value !== passInput.value || confirmInput.value === '') {
            errorDiv.style.display = 'block';
            confirmInput.classList.add('is-invalid');
            return false;
        } else {
            errorDiv.style.display = 'none';
            confirmInput.classList.remove('is-invalid');
            return true;
        }
    }

    // --- Gestion de la soumission globale (pour afficher les erreurs en haut comme sur l'image) ---
    document.getElementById('registerForm').addEventListener('submit', function(e) {
        e.preventDefault(); // Empêche l'envoi réel pour l'exercice
        
        let errors = [];
        
        // On re-vérifie tout manuellement pour générer le résumé
        if(!validateField(document.getElementById('prenom'), nameRegex, 'err-prenom')) errors.push("Firstname is required / too short");
        if(!validateField(document.getElementById('nom'), nameRegex, 'err-nom')) errors.push("Lastname is required / too short");
        if(!validateField(document.getElementById('email'), emailRegex, 'err-email')) errors.push("Email format is wrong");
        if(!validateField(document.getElementById('password'), passwordRegex, 'err-password')) errors.push("Password format is wrong");
        if(document.getElementById('confirm-password').value !== document.getElementById('password').value) errors.push("Passwords do not match");

        const globalErrorDiv = document.getElementById('global-errors');
        globalErrorDiv.innerHTML = ""; // Reset

        if(errors.length > 0) {
            errors.forEach(err => {
                globalErrorDiv.innerHTML += `<div>${err}</div>`;
            });
        } else {
            alert("Formulaire valide !");
        }
    });
</script>

</body>
</html>